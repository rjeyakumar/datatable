<table class="table table-cxo">
  <thead>
    <tr>
      <th ng-if="orderBook.type === 'fixed'">#</th>
      <th ng-repeat="headerCol in orderBook.columns" colspan="{{headerCol.subColumns ?  headerCol.subColumns.length : 0}}" rowspan="{{headerCol.subColumns ? 1 : 2}}">{{headerCol.name}}</th>
    </tr>
    <tr ng-if="orderBook.subColumns.length > 0">
      <th ng-if="orderBook.type === 'fixed'"></th>
      <th ng-data="{{subHeaderCol}}" ng-repeat="subHeaderCol in orderBook.subColumns">{{subHeaderCol.name}}</th>
    </tr>
  </thead>
  <tbody ng-if="orderBook.type !== 'fixed' && (!orderBook.data || orderBook.data.mainAccList.length === 0)">
    <tr>
      <td>No results found</td>
    </tr>
  </tbody>
  <tbody ng-if="orderBook.data && orderBook.data.mainAccList.length > 0">
    <tr class="table-crm-grand-bg">
      <td ng-if="orderBook.type === 'fixed'"></td>
      <td ng-if="col.key" ng-repeat="col in orderBook.rows">
        {{orderBook.data.grandTotal[col.key]}}
      </td>
    </tr>
    <tr class="table-crm-bg" ng-repeat-start="account in orderBook.data.mainAccList">
      <td ng-if="orderBook.type === 'fixed'">{{$index + 1}}</td>
      <td ng-if="col.key" ng-repeat="col in orderBook.rows">
        {{account.account[col.key]}}
      </td>
    </tr>
    <tr ng-repeat="agreement in account.agreement">
      <td ng-if="orderBook.type === 'fixed'"></td>
      <td ng-if="col.key" ng-repeat="col in orderBook.rows">
        <span>{{agreement[col.key]}}</span>
      </td>
    </tr>
    <tr ng-repeat="oppty in account.oppty">
      <td ng-if="orderBook.type === 'fixed'"></td>
      <td ng-if="col.key" ng-class="{red: col.name == 'Agreement Name'}" ng-repeat="col in orderBook.rows">
        {{oppty[col.key]}}
      </td>
    </tr>
    <tr ng-repeat="upside in account.upside">
      <td ng-if="orderBook.type === 'fixed'"></td>
      <td ng-if="col.key" ng-repeat="col in orderBook.rows">
        <div ng-switch="col.key">
          <select ng-switch-when="agreementCategory">
            <option ng-repeat="category in upside[col.key]" value="{{category.value}}">{{category.label}}</option>
          </select>
          <div ng-switch-default value="upside[col.key]" key="col.key" editable></div>
        </div>
      </td>
    </tr>
    <tr ng-repeat-end>
      <td ng-if="orderBook.type === 'fixed'"></td>
      <td ng-if="col.key" ng-repeat="col in orderBook.rows">
        <a ng-if="col.key === 'accountName'" class="glyphicon glyphicon-plus-sign" ng-click="orderBook.filterHandler({index: $parent.$parent.$parent.$index})"></a>
        <span ng-if="col.key === 'agreementCategory'">Add Row</span>
      </td>
    </tr>
  </tbody>
</table>